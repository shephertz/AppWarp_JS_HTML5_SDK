var AppWarp;!function(a){var b=b||function(a,b){var c={},d=c.lib={},e=function(){},f=d.Base={extend:function(a){e.prototype=this;var b=new e;return a&&b.mixIn(a),b.hasOwnProperty("init")||(b.init=function(){b.$super.init.apply(this,arguments)}),b.init.prototype=b,b.$super=this,b},create:function(){var a=this.extend();return a.init.apply(a,arguments),a},init:function(){},mixIn:function(a){for(var b in a)a.hasOwnProperty(b)&&(this[b]=a[b]);a.hasOwnProperty("toString")&&(this.toString=a.toString)},clone:function(){return this.init.prototype.extend(this)}},g=d.WordArray=f.extend({init:function(a,c){a=this.words=a||[],this.sigBytes=c!=b?c:4*a.length},toString:function(a){return(a||i).stringify(this)},concat:function(a){var b=this.words,c=a.words,d=this.sigBytes;if(a=a.sigBytes,this.clamp(),d%4)for(var e=0;a>e;e++)b[d+e>>>2]|=(255&c[e>>>2]>>>24-8*(e%4))<<24-8*((d+e)%4);else if(65535<c.length)for(e=0;a>e;e+=4)b[d+e>>>2]=c[e>>>2];else b.push.apply(b,c);return this.sigBytes+=a,this},clamp:function(){var b=this.words,c=this.sigBytes;b[c>>>2]&=4294967295<<32-8*(c%4),b.length=a.ceil(c/4)},clone:function(){var a=f.clone.call(this);return a.words=this.words.slice(0),a},random:function(b){for(var c=[],d=0;b>d;d+=4)c.push(0|4294967296*a.random());return new g.init(c,b)}}),h=c.enc={},i=h.Hex={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++){var e=255&b[d>>>2]>>>24-8*(d%4);c.push((e>>>4).toString(16)),c.push((15&e).toString(16))}return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d+=2)c[d>>>3]|=parseInt(a.substr(d,2),16)<<24-4*(d%8);return new g.init(c,b/2)}},j=h.Latin1={stringify:function(a){var b=a.words;a=a.sigBytes;for(var c=[],d=0;a>d;d++)c.push(String.fromCharCode(255&b[d>>>2]>>>24-8*(d%4)));return c.join("")},parse:function(a){for(var b=a.length,c=[],d=0;b>d;d++)c[d>>>2]|=(255&a.charCodeAt(d))<<24-8*(d%4);return new g.init(c,b)}},k=h.Utf8={stringify:function(a){try{return decodeURIComponent(escape(j.stringify(a)))}catch(b){throw Error("Malformed UTF-8 data")}},parse:function(a){return j.parse(unescape(encodeURIComponent(a)))}},l=d.BufferedBlockAlgorithm=f.extend({reset:function(){this._data=new g.init,this._nDataBytes=0},_append:function(a){"string"==typeof a&&(a=k.parse(a)),this._data.concat(a),this._nDataBytes+=a.sigBytes},_process:function(b){var c=this._data,d=c.words,e=c.sigBytes,f=this.blockSize,h=e/(4*f),h=b?a.ceil(h):a.max((0|h)-this._minBufferSize,0);if(b=h*f,e=a.min(4*b,e),b){for(var i=0;b>i;i+=f)this._doProcessBlock(d,i);i=d.splice(0,b),c.sigBytes-=e}return new g.init(i,e)},clone:function(){var a=f.clone.call(this);return a._data=this._data.clone(),a},_minBufferSize:0});d.Hasher=l.extend({cfg:f.extend(),init:function(a){this.cfg=this.cfg.extend(a),this.reset()},reset:function(){l.reset.call(this),this._doReset()},update:function(a){return this._append(a),this._process(),this},finalize:function(a){return a&&this._append(a),this._doFinalize()},blockSize:16,_createHelper:function(a){return function(b,c){return new a.init(c).finalize(b)}},_createHmacHelper:function(a){return function(b,c){return new m.HMAC.init(a,c).finalize(b)}}});var m=c.algo={};return c}(Math);!function(){var a=b,c=a.lib,d=c.WordArray,e=c.Hasher,f=[],c=a.algo.SHA1=e.extend({_doReset:function(){this._hash=new d.init([1732584193,4023233417,2562383102,271733878,3285377520])},_doProcessBlock:function(a,b){for(var c=this._hash.words,d=c[0],e=c[1],g=c[2],h=c[3],i=c[4],j=0;80>j;j++){if(16>j)f[j]=0|a[b+j];else{var k=f[j-3]^f[j-8]^f[j-14]^f[j-16];f[j]=k<<1|k>>>31}k=(d<<5|d>>>27)+i+f[j],k=20>j?k+((e&g|~e&h)+1518500249):40>j?k+((e^g^h)+1859775393):60>j?k+((e&g|e&h|g&h)-1894007588):k+((e^g^h)-899497514),i=h,h=g,g=e<<30|e>>>2,e=d,d=k}c[0]=0|c[0]+d,c[1]=0|c[1]+e,c[2]=0|c[2]+g,c[3]=0|c[3]+h,c[4]=0|c[4]+i},_doFinalize:function(){var a=this._data,b=a.words,c=8*this._nDataBytes,d=8*a.sigBytes;return b[d>>>5]|=128<<24-d%32,b[(d+64>>>9<<4)+14]=Math.floor(c/4294967296),b[(d+64>>>9<<4)+15]=c,a.sigBytes=4*b.length,this._process(),this._hash},clone:function(){var a=e.clone.call(this);return a._hash=this._hash.clone(),a}});a.SHA1=e._createHelper(c),a.HmacSHA1=e._createHmacHelper(c)}(),function(){var a=b,c=a.enc.Utf8;a.algo.HMAC=a.lib.Base.extend({init:function(a,b){a=this._hasher=new a.init,"string"==typeof b&&(b=c.parse(b));var d=a.blockSize,e=4*d;b.sigBytes>e&&(b=a.finalize(b)),b.clamp();for(var f=this._oKey=b.clone(),g=this._iKey=b.clone(),h=f.words,i=g.words,j=0;d>j;j++)h[j]^=1549556828,i[j]^=909522486;f.sigBytes=g.sigBytes=e,this.reset()},reset:function(){var a=this._hasher;a.reset(),a.update(this._iKey)},update:function(a){return this._hasher.update(a),this},finalize:function(a){var b=this._hasher;return a=b.finalize(a),b.reset(),b.finalize(this._oKey.clone().concat(a))}})}(),a.CryptoJS=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a,b){this.json=JSON.parse(b),this.res=a}return a.prototype.getResult=function(){return this.res},a.prototype.getRoomIds=function(){var a=this.json.ids,b=a.split(";");return b.length>0&&b.pop(),b},a}();a.AllRoomsEvent=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a,b){this.json=JSON.parse(b),this.res=a}return a.prototype.getResult=function(){return this.res},a.prototype.getUsernames=function(){var a=this.json.names,b=a.split(";");return b.length>0&&b.pop(),b},a}();a.AllUsersEvent=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a){this.json=JSON.parse(a)}return a.prototype.getChat=function(){return this.json.chat},a.prototype.getSender=function(){return this.json.sender},a.prototype.getLocId=function(){return this.json.id},a.prototype.getIsLocationLobby=function(){return this.json.isLobby?!0:!1},a}();a.Chat=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){!function(a){a[a.Auth=1]="Auth",a[a.JoinLobby=2]="JoinLobby",a[a.SubscribeLobby=3]="SubscribeLobby",a[a.UnsubscribeLobby=4]="UnsubscribeLobby",a[a.LeaveLobby=5]="LeaveLobby",a[a.CreateRoom=6]="CreateRoom",a[a.JoinRoom=7]="JoinRoom",a[a.SubscribeRoom=8]="SubscribeRoom",a[a.UnsubscribeRoom=9]="UnsubscribeRoom",a[a.LeaveRoom=10]="LeaveRoom",a[a.DeleteRoom=11]="DeleteRoom",a[a.Chat=12]="Chat",a[a.UpdatePeers=13]="UpdatePeers",a[a.Signout=14]="Signout",a[a.CreateZone=15]="CreateZone",a[a.DeleteZone=16]="DeleteZone",a[a.GetRooms=17]="GetRooms",a[a.GetUsers=18]="GetUsers",a[a.GetUserInfo=19]="GetUserInfo",a[a.GetRoomInfo=20]="GetRoomInfo",a[a.SetCustomRoomData=21]="SetCustomRoomData",a[a.SetCustomUserData=22]="SetCustomUserData",a[a.GetLobbyInfo=23]="GetLobbyInfo",a[a.JoinRoomWithNUser=24]="JoinRoomWithNUser",a[a.UpdateRoomProperty=25]="UpdateRoomProperty",a[a.JoinRoomWithProperties=27]="JoinRoomWithProperties",a[a.GetRoomWithNUser=28]="GetRoomWithNUser",a[a.GetRoomWithProperties=29]="GetRoomWithProperties",a[a.JoinRoomInRange=37]="JoinRoomInRange",a[a.GetRoomInRange=38]="GetRoomInRange",a[a.LockProperties=35]="LockProperties",a[a.UnlockProperties=36]="UnlockProperties",a[a.KeepAlive=63]="KeepAlive",a[a.PrivateChat=30]="PrivateChat",a[a.Move=31]="Move"}(a.RequestType||(a.RequestType={})),a.RequestType,function(a){a[a.FlatString=0]="FlatString",a[a.Binary=1]="Binary",a[a.Json=2]="Json"}(a.PayloadType||(a.PayloadType={})),a.PayloadType,function(a){a[a.Request=0]="Request",a[a.Response=1]="Response",a[a.Update=2]="Update"}(a.MessageType||(a.MessageType={})),a.MessageType,function(a){a[a.Success=0]="Success",a[a.AuthError=1]="AuthError",a[a.ResourceNotFound=2]="ResourceNotFound",a[a.ResourceMoved=3]="ResourceMoved",a[a.BadRequest=4]="BadRequest",a[a.ConnectionError=5]="ConnectionError",a[a.UnknownError=6]="UnknownError",a[a.ResultSizeError=7]="ResultSizeError",a[a.ApiNotFound=8]="ApiNotFound"}(a.ResultCode||(a.ResultCode={})),a.ResultCode,function(a){a[a.RoomCreated=1]="RoomCreated",a[a.RoomDeleted=2]="RoomDeleted",a[a.UserJoinedLobby=3]="UserJoinedLobby",a[a.UserLeftLobby=4]="UserLeftLobby",a[a.UserJoinedRoom=5]="UserJoinedRoom",a[a.UserLeftRoom=6]="UserLeftRoom",a[a.UserOnline=7]="UserOnline",a[a.UserOffline=8]="UserOffline",a[a.Chat=9]="Chat",a[a.UpdatePeers=10]="UpdatePeers",a[a.RoomPropertyChange=11]="RoomPropertyChange",a[a.PrivateChat=12]="PrivateChat",a[a.MoveCompleted=13]="MoveCompleted"}(a.UpdateType||(a.UpdateType={})),a.UpdateType,function(a){a[a.MaxPropertySizeBytes=2048]="MaxPropertySizeBytes",a[a.AssocPort=64]="AssocPort"}(a.Constants||(a.Constants={})),a.Constants}(AppWarp||(AppWarp={}));var AppWarp;!function(a){!function(a){a[a.onConnectDone=0]="onConnectDone",a[a.onDisconnectDone=1]="onDisconnectDone",a[a.onJoinLobbyDone=2]="onJoinLobbyDone",a[a.onLeaveLobbyDone=3]="onLeaveLobbyDone",a[a.onSubscribeLobbyDone=4]="onSubscribeLobbyDone",a[a.onUnsubscribeLobbyDone=5]="onUnsubscribeLobbyDone",a[a.onGetLiveLobbyInfoDone=6]="onGetLiveLobbyInfoDone",a[a.onSubscribeRoomDone=7]="onSubscribeRoomDone",a[a.onUnsubscribeRoomDone=8]="onUnsubscribeRoomDone",a[a.onJoinRoomDone=9]="onJoinRoomDone",a[a.onLeaveRoomDone=10]="onLeaveRoomDone",a[a.onGetLiveRoomInfoDone=11]="onGetLiveRoomInfoDone",a[a.onSetCustomRoomDataDone=12]="onSetCustomRoomDataDone",a[a.onUpdatePropertyDone=13]="onUpdatePropertyDone",a[a.onLockPropertiesDone=14]="onLockPropertiesDone",a[a.onUnlockPropertiesDone=15]="onUnlockPropertiesDone",a[a.onCreateRoomDone=16]="onCreateRoomDone",a[a.onDeleteRoomDone=17]="onDeleteRoomDone",a[a.onGetAllRoomsDone=18]="onGetAllRoomsDone",a[a.onGetOnlineUsersDone=19]="onGetOnlineUsersDone",a[a.onGetLiveUserInfoDone=20]="onGetLiveUserInfoDone",a[a.onSetCustomUserDataDone=21]="onSetCustomUserDataDone",a[a.onGetMatchedRoomsDone=22]="onGetMatchedRoomsDone",a[a.onRoomCreated=23]="onRoomCreated",a[a.onRoomDestroyed=24]="onRoomDestroyed",a[a.onUserLeftRoom=25]="onUserLeftRoom",a[a.onUserJoinedRoom=26]="onUserJoinedRoom",a[a.onUserLeftLobby=27]="onUserLeftLobby",a[a.onUserJoinedLobby=28]="onUserJoinedLobby",a[a.onChatReceived=29]="onChatReceived",a[a.onUpdatePeersReceived=30]="onUpdatePeersReceived",a[a.onUserChangeRoomProperty=31]="onUserChangeRoomProperty",a[a.onPrivateChatReceived=32]="onPrivateChatReceived",a[a.onMoveCompleted=33]="onMoveCompleted",a[a.onSendChatDone=34]="onSendChatDone",a[a.onSendPrivateChatDone=35]="onSendPrivateChatDone",a[a.onSendUpdateDone=36]="onSendUpdateDone",a[a.onSendMoveDone=37]="onSendMoveDone"}(a.Events||(a.Events={})),a.Events}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function b(a,b){this.json=JSON.parse(b),this.res=a}return b.prototype.getResult=function(){return this.res},b.prototype.getRoom=function(){return new a.Room(this.res,JSON.stringify(this.json))},b.prototype.getCustomData=function(){return this.json.data},b.prototype.getProperties=function(){return this.json.properties},b.prototype.getUsers=function(){var a=this.json.usernames,b=a.split(";");return b.length>0&&b.pop(),b},b}();a.LiveRoom=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a,b){this.json=JSON.parse(b),this.res=a}return a.prototype.getResult=function(){return this.res},a.prototype.getName=function(){return this.json.name},a.prototype.getLocationId=function(){return this.json.locationId},a.prototype.getCustomData=function(){return this.json.custom},a.prototype.isLobby=function(){return this.json.isLobby?this.json.isLobby:!1},a}();a.LiveUser=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a,b){this.json=JSON.parse(b),this.res=a}return a.prototype.getResult=function(){return this.res},a.prototype.getLobbyId=function(){return this.json.id},a.prototype.getOwner=function(){return this.json.owner},a.prototype.getName=function(){return this.json.name},a.prototype.getIsPrimary=function(){return this.json.isPrimary},a.prototype.getMaxUsers=function(){return this.json.maxUsers},a}();a.Lobby=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a,b){this.json=JSON.parse(b),this.res=a}return a.prototype.getResult=function(){return this.res},a.prototype.getRooms=function(){var a=[],b=0;for(var c in this.json){var d={};d.id=c,d.name=this.json[c].name,d.owner=this.json[c].owner,d.maxUsers=this.json[c].maxUsers,a[b]=d,b++}return a},a}();a.MatchedRoomEvent=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a){this.json=JSON.parse(a)}return a.prototype.getSender=function(){return this.json.sender},a.prototype.getNextTurn=function(){return this.json.nextTurn},a.prototype.getMoveData=function(){return this.json.moveData},a.prototype.getRoomId=function(){this.json.roomId},a}();a.Move=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function b(b,c){this.messageType=b[c+0],this.updateType=b[c+1],this.reserved=b[c+2],this.payLoadType=b[c+3],this.payLoadSize=a.Utility.bytesToIntger(b,c+4),this.payLoad=new Uint8Array(this.payLoadSize);for(var d=0;d<this.payLoadSize;d++)this.payLoad[d]=b[8+c+d]}return b.prototype.getMessageType=function(){return this.messageType},b.prototype.getUpdateType=function(){return this.updateType},b.prototype.getPayloadType=function(){return this.payLoadType},b.prototype.getPayloadSize=function(){return this.payLoadSize},b.prototype.getPayload=function(){return this.payLoad},b.prototype.getPayloadString=function(){return a.Utility.bin2String(this.payLoad)},b.prototype.debug=function(){console.log("=========Notify========="),console.log("messageType : "+a.MessageType[this.getMessageType()]),console.log("updateType  : "+a.UpdateType[this.getUpdateType()]),console.log("payLoadType : "+a.PayloadType[this.getPayloadType()]),console.log("payLoadSize : "+this.getPayloadSize()),console.log("payLoad     : "+this.getPayloadString())},b}();a.Notify=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function b(){}return b.buildWarpRequest=function(b,c,d,e){var f=new Uint8Array(16+d.length);f[0]=a.MessageType.Request,f[1]=c,f[2]=b>>>24,f[3]=b>>>16,f[4]=b>>>8,f[5]=b;for(var g=6;9>=g;g++)f[g]=0;f[10]=0,f[11]=d.length>0&&c!=a.RequestType.UpdatePeers?a.PayloadType.Json:a.PayloadType.Binary;var h=d.length;if(f[12]=h>>>24,f[13]=h>>>16,f[14]=h>>>8,f[15]=h,0==e)for(var g=0;h>g;++g)f[16+g]=d[g];else for(var g=0;h>g;++g)f[16+g]=d.charCodeAt(g);return f},b.buildAuthRequest=function(b,c,d){var e=a.Utility.getODataUTCDateFilter(),f="";f+="apiKey"+b,f+="timeStamp"+e,f+="user"+d,f+="versionJS_1.2";var g=a.CryptoJS.HmacSHA1(f,c).toString(),h=encodeURIComponent(a.Utility.base64_encode(a.Utility.hex2bin(g))),i={};return i.apiKey=b,i.version="JS_1.2",i.timeStamp=e,i.user=d,i.signature=h,i.keepalive=6,JSON.stringify(i)},b.buildLobbyRequest=function(){var a={};return a.isPrimary=!0,JSON.stringify(a)},b.buildChatRequest=function(a){if(a.length>=512)return"";var b={};return b.chat=a,JSON.stringify(b)},b.buildPrivateChatRequest=function(a,b){if(b.length>=512)return"";var c={};return c.to=a,c.chat=b,JSON.stringify(c)},b.buildRoomRequest=function(a){var b={};return b.id=a,JSON.stringify(b)},b.buildUserRequest=function(a){var b={};return b.name=a,JSON.stringify(b)},b.buildRoomInRangeRequest=function(a,b,c){var d={};return d.minUsers=a,d.maxUsers=b,d.maxPreferred=c,JSON.stringify(d)},b.buildRoomWithPropertiesRequest=function(a){var b={};return b.properties=a,JSON.stringify(b)},b.buildSetCustomRoomDataRequest=function(a,b){var c={};return c.id=a,c.data=b,JSON.stringify(c)},b.buildSetCustomUserDataRequest=function(a,b){var c={};return c.name=a,c.data=b,JSON.stringify(c)},b.buildUpdateRoomPropertiesRequest=function(a,b,c){"undefined"==typeof c&&(c=null);var d="";if(null!=c&&c.length>0)for(var e=0;e<c.length;++e)d+=e<c.length-1?c[e]+";":c[e];var f={};return f.id=a,f.addOrUpdate=b,f.remove=d,JSON.stringify(f)},b.buildLockPropertiesRequest=function(a){var b={};return b.lockProperties=a,JSON.stringify(b)},b.buildUnlockPropertiesRequest=function(a){var b="";if(a&&a.length>0)for(var c=0;c<a.length;++c)b+=c<a.length-1?a[c]+";":a[c];var d={};return d.unlockProperties=b,JSON.stringify(d)},b.buildCreateTurnRoomRequest=function(a,b,c,d,e){"undefined"==typeof d&&(d=null),"undefined"==typeof e&&(e=-1);var f={};return f.name=a,f.owner=b,f.maxUsers=c,null!=d&&(f.addOrUpdate=d),e>=0&&(f.turnTime=e),JSON.stringify(f)},b.buildSendMoveRequest=function(a){var b={};return b.moveData=a,JSON.stringify(b)},b}();a.RequestBuilder=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function b(b,c){this.messageType=b[c+0],this.requestType=b[c+1],this.resultCode=b[c+2],this.reserved=b[c+3],this.payLoadType=b[c+4],this.payLoadSize=a.Utility.bytesToIntger(b,c+5),this.payLoad=new Uint8Array(this.payLoadSize);for(var d=0;d<this.payLoadSize;d++)this.payLoad[d]=b[9+c+d]}return b.prototype.getMessageType=function(){return this.messageType},b.prototype.getRequestType=function(){return this.requestType},b.prototype.getResultCode=function(){return this.resultCode},b.prototype.getPayloadType=function(){return this.payLoadType},b.prototype.getPayloadSize=function(){return this.payLoadSize},b.prototype.getPayload=function(){return this.payLoad},b.prototype.getPayloadString=function(){return a.Utility.bin2String(this.payLoad)},b.prototype.debug=function(){console.log("========Response========"),console.log("messageType : "+a.MessageType[this.getMessageType()]),console.log("requestType : "+a.RequestType[this.getRequestType()]),console.log("resultCode  : "+this.getResultCode()),console.log("payLoadType : "+a.PayloadType[this.getPayloadType()]),console.log("payLoadSize : "+this.getPayloadSize()),console.log("payLoad     : "+this.getPayloadString())},b}();a.Response=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(a,b){this.json=JSON.parse(b),this.res=a}return a.prototype.getResult=function(){return this.res},a.prototype.getRoomId=function(){return this.json.id},a.prototype.getOwner=function(){return this.json.owner},a.prototype.getName=function(){return this.json.name},a.prototype.getMaxUsers=function(){return this.json.maxUsers},a}();a.Room=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function a(){}return a.getODataUTCDateFilter=function(){var a,b=new Date,c=(b.getUTCMonth()+1).toString();a=1==c.length?"0"+c:c;var d,e=b.getUTCDate().toString();d=1==e.length?"0"+e:e;var f="";return f+=b.getUTCFullYear()+"-",f+=a+"-",f+=d,f+="T"+b.getUTCHours()+":",f+=b.getUTCMinutes()+":",f+=b.getUTCSeconds()+".",f+=b.getUTCMilliseconds(),f+="Z"},a.hex2bin=function(a){for(var b=[],c=0;c<a.length-1;c+=2)b.push(parseInt(a.substr(c,2),16));return String.fromCharCode.apply(String,b)},a.base64_encode=function(a){var b,c,d,e,f,g,h,i,j="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",k=0,l=0,m="",n=[];if(!a)return a;do b=a.charCodeAt(k++),c=a.charCodeAt(k++),d=a.charCodeAt(k++),i=b<<16|c<<8|d,e=63&i>>18,f=63&i>>12,g=63&i>>6,h=63&i,n[l++]=j.charAt(e)+j.charAt(f)+j.charAt(g)+j.charAt(h);while(k<a.length);m=n.join("");var o=a.length%3;return(o?m.slice(0,o-3):m)+"===".slice(o||3)},a.bin2String=function(a){for(var b="",c=0;c<a.length;c++){var d=a[c];b+=String.fromCharCode(d)}return b},a.bytesToIntger=function(a,b){for(var c=0,d=0;4>d;d++)c=(c<<8)+(255&a[b+d]);return c},a}();a.Utility=b}(AppWarp||(AppWarp={}));var AppWarp;!function(a){var b=function(){function b(){if(this.responseCallbacks=[],this.updateCallbacks=[],this.SessionID=0,this.isConnected=!1,this.timeout=0,b.instance)throw new Error("Error: Instantiation failed: Use WarpClient.getInstance() instead of new.");b.instance=this,setInterval(function(){if(1==this.AppWarp.WarpClient.instance.isConnected){var b=(new Date).getTime(),c=b-this.AppWarp.WarpClient.instance.timeout;if(c>2e3){var d=this.AppWarp.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.KeepAlive,"",!0);this.AppWarp.WarpClient.instance.sendMessage(d.buffer)}}},500)}return b.initialize=function(a,c,d){"undefined"==typeof d&&(d=""),b.apiKey=a,b.secretKey=c,b.serverAddress=d},b.getInstance=function(){return null==b.instance&&(b.instance=new b),b.instance},b.prototype.sendMessage=function(a){this.socket.send(a),this.timeout=(new Date).getTime()},b.prototype.onMessage=function(b){for(var c=new Uint8Array(b.data),d=c.length,e=0;d>e;)if(c[e]==a.MessageType.Response){var f=new a.Response(c,e);e+=this.handleResponse(f)}else if(c[e]==a.MessageType.Update){var g=new a.Notify(c,e);e+=this.handleNotify(g)}},b.prototype.handleResponse=function(b){if(b.getRequestType()==a.RequestType.Auth){if(b.getResultCode()==a.ResultCode.Success){var c=JSON.parse(b.getPayloadString());this.SessionID=c.sessionid,this.isConnected=!0}else this.isConnected=!1;this.responseCallbacks[a.Events.onConnectDone]&&this.responseCallbacks[a.Events.onConnectDone](b.getResultCode())}else if(b.getRequestType()==a.RequestType.JoinLobby){var d=new a.Lobby(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onJoinLobbyDone]&&this.responseCallbacks[a.Events.onJoinLobbyDone](d)}else if(b.getRequestType()==a.RequestType.SubscribeLobby){var d=new a.Lobby(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onSubscribeLobbyDone]&&this.responseCallbacks[a.Events.onSubscribeLobbyDone](d)}else if(b.getRequestType()==a.RequestType.UnsubscribeLobby){var d=new a.Lobby(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onUnsubscribeLobbyDone]&&this.responseCallbacks[a.Events.onUnsubscribeLobbyDone](d)}else if(b.getRequestType()==a.RequestType.LeaveLobby){var d=new a.Lobby(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onLeaveLobbyDone]&&this.responseCallbacks[a.Events.onLeaveLobbyDone](d)}else if(b.getRequestType()==a.RequestType.Chat)this.responseCallbacks[a.Events.onSendChatDone]&&this.responseCallbacks[a.Events.onSendChatDone](b.getResultCode());else if(b.getRequestType()==a.RequestType.JoinRoom||b.getRequestType()==a.RequestType.JoinRoomInRange||b.getRequestType()==a.RequestType.JoinRoomWithProperties){var e=new a.Room(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onJoinRoomDone]&&this.responseCallbacks[a.Events.onJoinRoomDone](e)}else if(b.getRequestType()==a.RequestType.SubscribeRoom){var e=new a.Room(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onSubscribeRoomDone]&&this.responseCallbacks[a.Events.onSubscribeRoomDone](e)}else if(b.getRequestType()==a.RequestType.UnsubscribeRoom){var e=new a.Room(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onUnsubscribeRoomDone]&&this.responseCallbacks[a.Events.onUnsubscribeRoomDone](e)}else if(b.getRequestType()==a.RequestType.LeaveRoom){var e=new a.Room(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onLeaveRoomDone]&&this.responseCallbacks[a.Events.onLeaveRoomDone](e)}else if(b.getRequestType()==a.RequestType.CreateRoom){var e=new a.Room(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onCreateRoomDone]&&this.responseCallbacks[a.Events.onCreateRoomDone](e)}else if(b.getRequestType()==a.RequestType.DeleteRoom){var e=new a.Room(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onDeleteRoomDone]&&this.responseCallbacks[a.Events.onDeleteRoomDone](e)}else if(b.getRequestType()==a.RequestType.GetRoomInfo){var f=new a.LiveRoom(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onGetLiveRoomInfoDone]&&this.responseCallbacks[a.Events.onGetLiveRoomInfoDone](f)}else if(b.getRequestType()==a.RequestType.GetLobbyInfo){var f=new a.LiveRoom(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onGetLiveLobbyInfoDone]&&this.responseCallbacks[a.Events.onGetLiveLobbyInfoDone](f)}else if(b.getRequestType()==a.RequestType.GetUserInfo){var g=new a.LiveUser(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onGetLiveUserInfoDone]&&this.responseCallbacks[a.Events.onGetLiveUserInfoDone](g)}else if(b.getRequestType()==a.RequestType.SetCustomUserData){var g=new a.LiveUser(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onSetCustomUserDataDone]&&this.responseCallbacks[a.Events.onSetCustomUserDataDone](g)}else if(b.getRequestType()==a.RequestType.SetCustomRoomData){var f=new a.LiveRoom(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onSetCustomRoomDataDone]&&this.responseCallbacks[a.Events.onSetCustomRoomDataDone](f)}else if(b.getRequestType()==a.RequestType.GetUsers){var h=new a.AllUsersEvent(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onGetOnlineUsersDone]&&this.responseCallbacks[a.Events.onGetOnlineUsersDone](h)}else if(b.getRequestType()==a.RequestType.GetRooms){var i=new a.AllRoomsEvent(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onGetAllRoomsDone]&&this.responseCallbacks[a.Events.onGetAllRoomsDone](i)}else if(b.getRequestType()==a.RequestType.GetRoomInRange||b.getRequestType()==a.RequestType.GetRoomWithProperties){var j=new a.MatchedRoomEvent(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onGetMatchedRoomsDone]&&this.responseCallbacks[a.Events.onGetMatchedRoomsDone](j)}else if(b.getRequestType()==a.RequestType.UpdatePeers)this.responseCallbacks[a.Events.onSendUpdateDone]&&this.responseCallbacks[a.Events.onSendUpdateDone](b.getResultCode());else if(b.getRequestType()==a.RequestType.PrivateChat)this.responseCallbacks[a.Events.onSendPrivateChatDone]&&this.responseCallbacks[a.Events.onSendPrivateChatDone](b.getResultCode());else if(b.getRequestType()==a.RequestType.UpdateRoomProperty){var f=new a.LiveRoom(b.getResultCode(),b.getPayloadString());this.responseCallbacks[a.Events.onUpdatePropertyDone]&&this.responseCallbacks[a.Events.onUpdatePropertyDone](f)}else b.getRequestType()==a.RequestType.LockProperties?this.responseCallbacks[a.Events.onLockPropertiesDone]&&this.responseCallbacks[a.Events.onLockPropertiesDone](b.getResultCode()):b.getRequestType()==a.RequestType.UnlockProperties?this.responseCallbacks[a.Events.onUnlockPropertiesDone]&&this.responseCallbacks[a.Events.onUnlockPropertiesDone](b.getResultCode()):b.getRequestType()==a.RequestType.Move&&this.responseCallbacks[a.Events.onSendMoveDone]&&this.responseCallbacks[a.Events.onSendMoveDone](b.getResultCode());return 9+b.getPayloadSize()},b.prototype.handleNotify=function(b){if(b.getUpdateType()==a.UpdateType.Chat){var c=new a.Chat(b.getPayloadString());this.updateCallbacks[a.Events.onChatReceived]&&this.updateCallbacks[a.Events.onChatReceived](c)}else if(b.getUpdateType()==a.UpdateType.RoomCreated){var d=new a.Room(0,b.getPayloadString());this.updateCallbacks[a.Events.onRoomCreated]&&this.updateCallbacks[a.Events.onRoomCreated](d)}else if(b.getUpdateType()==a.UpdateType.RoomDeleted){var d=new a.Room(0,b.getPayloadString());this.updateCallbacks[a.Events.onRoomDestroyed]&&this.updateCallbacks[a.Events.onRoomDestroyed](d)}else if(b.getUpdateType()==a.UpdateType.UpdatePeers)this.updateCallbacks[a.Events.onUpdatePeersReceived]&&this.updateCallbacks[a.Events.onUpdatePeersReceived](b.getPayload());else if(b.getUpdateType()==a.UpdateType.UserJoinedLobby){var e=new a.Lobby(0,b.getPayloadString()),f=JSON.parse(b.getPayloadString()).user;this.updateCallbacks[a.Events.onUserJoinedLobby]&&this.updateCallbacks[a.Events.onUserJoinedLobby](e,f)}else if(b.getUpdateType()==a.UpdateType.UserLeftLobby){var e=new a.Lobby(0,b.getPayloadString()),f=JSON.parse(b.getPayloadString()).user;this.updateCallbacks[a.Events.onUserLeftLobby]&&this.updateCallbacks[a.Events.onUserLeftLobby](e,f)}else if(b.getUpdateType()==a.UpdateType.UserJoinedRoom){var d=new a.Room(0,b.getPayloadString()),f=JSON.parse(b.getPayloadString()).user;this.updateCallbacks[a.Events.onUserJoinedRoom]&&this.updateCallbacks[a.Events.onUserJoinedRoom](d,f)}else if(b.getUpdateType()==a.UpdateType.UserLeftRoom){var d=new a.Room(0,b.getPayloadString()),f=JSON.parse(b.getPayloadString()).user;this.updateCallbacks[a.Events.onUserLeftRoom]&&this.updateCallbacks[a.Events.onUserLeftRoom](d,f)}else if(b.getUpdateType()==a.UpdateType.PrivateChat){var g=JSON.parse(b.getPayloadString());this.updateCallbacks[a.Events.onPrivateChatReceived]&&this.updateCallbacks[a.Events.onPrivateChatReceived](g.sender,g.chat)}else if(b.getUpdateType()==a.UpdateType.RoomPropertyChange){var g=JSON.parse(b.getPayloadString());this.updateCallbacks[a.Events.onUserChangeRoomProperty]&&this.updateCallbacks[a.Events.onUserChangeRoomProperty](g.sender,g.properties,g.lockProperties)}else if(b.getUpdateType()==a.UpdateType.MoveCompleted){var h=new a.Move(b.getPayloadString());this.updateCallbacks[a.Events.onMoveCompleted]&&this.updateCallbacks[a.Events.onMoveCompleted](h)}return 8+b.getPayloadSize()},b.prototype.joinZone=function(c){var d=a.RequestBuilder.buildAuthRequest(b.apiKey,b.secretKey,c),e=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.Auth,d,!0);this.sendMessage(e.buffer)},b.prototype.setResponseListener=function(a,b){this.responseCallbacks[a]=b},b.prototype.resetResponseListener=function(a){this.responseCallbacks[a]&&delete this.responseCallbacks[a]},b.prototype.setNotifyListener=function(a,b){this.updateCallbacks[a]=b},b.prototype.resetNotifyListener=function(a){this.updateCallbacks[a]&&delete this.updateCallbacks[a]},b.prototype.connect=function(c){if(""==b.serverAddress){var d=new XMLHttpRequest,e=this;d.onreadystatechange=function(){if(4==d.readyState&&200==d.status){var b=JSON.parse(d.responseText);b.address&&(e.socket=new WebSocket("ws://"+b.address+":12346"),e.socket.binaryType="arraybuffer",e.socket.onopen=function(){c?e.joinZone(c):e.responseCallbacks[a.Events.onConnectDone]&&e.responseCallbacks[a.Events.onConnectDone](a.ResultCode.BadRequest)},e.socket.onclose=function(){e.isConnected=!1,e.responseCallbacks[a.Events.onConnectDone]&&e.responseCallbacks[a.Events.onConnectDone](a.ResultCode.ConnectionError)},e.socket.onmessage=function(a){e.onMessage(a)})}else 4==d.readyState&&404==d.status&&e.responseCallbacks[a.Events.onConnectDone]&&e.responseCallbacks[a.Events.onConnectDone](a.ResultCode.ApiNotFound)},d.open("GET","http://control.appwarp.shephertz.com/lookup?api="+b.apiKey,!0),d.send()}else{this.socket=new WebSocket("ws://"+b.serverAddress+":12346"),this.socket.binaryType="arraybuffer";var e=this;this.socket.onopen=function(){c?e.joinZone(c):e.responseCallbacks[a.Events.onConnectDone]&&e.responseCallbacks[a.Events.onConnectDone](a.ResultCode.BadRequest)},this.socket.onclose=function(){e.isConnected=!1,e.responseCallbacks[a.Events.onConnectDone]&&e.responseCallbacks[a.Events.onConnectDone](a.ResultCode.ConnectionError)},this.socket.onmessage=function(a){e.onMessage(a)}}},b.prototype.disconnect=function(){this.isConnected=!1,this.socket.onclose=function(){},this.socket.close(),this.responseCallbacks[a.Events.onDisconnectDone]&&this.responseCallbacks[a.Events.onDisconnectDone](a.ResultCode.Success)},b.prototype.joinLobby=function(){var b=a.RequestBuilder.buildLobbyRequest(),c=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.JoinLobby,b,!0);this.sendMessage(c.buffer)},b.prototype.subscribeLobby=function(){var b=a.RequestBuilder.buildLobbyRequest(),c=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.SubscribeLobby,b,!0);this.sendMessage(c.buffer)},b.prototype.unsubscribeLobby=function(){var b=a.RequestBuilder.buildLobbyRequest(),c=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.UnsubscribeLobby,b,!0);this.sendMessage(c.buffer)},b.prototype.leaveLobby=function(){var b=a.RequestBuilder.buildLobbyRequest(),c=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.LeaveLobby,b,!0);this.sendMessage(c.buffer)},b.prototype.joinRoom=function(b){var c=a.RequestBuilder.buildRoomRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.JoinRoom,c,!0);this.sendMessage(d.buffer)},b.prototype.joinRoomInRange=function(b,c,d){var e=a.RequestBuilder.buildRoomInRangeRequest(b,c,d),f=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.JoinRoomInRange,e,!0);this.sendMessage(f.buffer)},b.prototype.joinRoomWithProperties=function(b){var c=a.RequestBuilder.buildRoomWithPropertiesRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.JoinRoomWithProperties,c,!0);
this.sendMessage(d.buffer)},b.prototype.subscribeRoom=function(b){var c=a.RequestBuilder.buildRoomRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.SubscribeRoom,c,!0);this.sendMessage(d.buffer)},b.prototype.unsubscribeRoom=function(b){var c=a.RequestBuilder.buildRoomRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.UnsubscribeRoom,c,!0);this.sendMessage(d.buffer)},b.prototype.leaveRoom=function(b){var c=a.RequestBuilder.buildRoomRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.LeaveRoom,c,!0);this.sendMessage(d.buffer)},b.prototype.createRoom=function(b,c,d,e){"undefined"==typeof e&&(e=null);var f={};if(f.name=b,f.owner=c,f.maxUsers=d,null!=e){if(JSON.stringify(e).length>a.Constants.MaxPropertySizeBytes){if(this.responseCallbacks[a.Events.onCreateRoomDone]){var g=new a.Room(a.ResultCode.ResultSizeError,"");this.responseCallbacks[a.Events.onCreateRoomDone](g)}return}f.properties=e}var h=JSON.stringify(f),i=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.CreateRoom,h,!0);this.sendMessage(i.buffer)},b.prototype.deleteRoom=function(b){var c=a.RequestBuilder.buildRoomRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.DeleteRoom,c,!0);this.sendMessage(d.buffer)},b.prototype.getLiveRoomInfo=function(b){var c=a.RequestBuilder.buildRoomRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetRoomInfo,c,!0);this.sendMessage(d.buffer)},b.prototype.getLiveLobbyInfo=function(){var b=a.RequestBuilder.buildLobbyRequest(),c=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetLobbyInfo,b,!0);this.sendMessage(c.buffer)},b.prototype.getLiveUserInfo=function(b){var c=a.RequestBuilder.buildUserRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetUserInfo,c,!0);this.sendMessage(d.buffer)},b.prototype.setCustomUserData=function(b,c){var d=a.RequestBuilder.buildSetCustomUserDataRequest(b,c),e=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.SetCustomUserData,d,!0);this.sendMessage(e.buffer)},b.prototype.setCustomRoomData=function(b,c){var d=a.RequestBuilder.buildSetCustomRoomDataRequest(b,c),e=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.SetCustomRoomData,d,!0);this.sendMessage(e.buffer)},b.prototype.getOnlineUsers=function(){var b=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetUsers,"",!0);this.sendMessage(b.buffer)},b.prototype.getAllRooms=function(){var b=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetRooms,"",!0);this.sendMessage(b.buffer)},b.prototype.getRoomsInRange=function(b,c){var d=a.RequestBuilder.buildRoomInRangeRequest(b,c,!0),e=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetRoomInRange,d,!0);this.sendMessage(e.buffer)},b.prototype.getRoomsWithProperties=function(b){var c=a.RequestBuilder.buildRoomWithPropertiesRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.GetRoomWithProperties,c,!0);this.sendMessage(d.buffer)},b.prototype.sendChat=function(b){var c=a.RequestBuilder.buildChatRequest(b);if(""==c)this.responseCallbacks[a.Events.onSendChatDone]&&this.responseCallbacks[a.Events.onSendChatDone](a.ResultCode.BadRequest);else{var d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.Chat,c,!0);this.sendMessage(d.buffer)}},b.prototype.sendUpdatePeers=function(b){if(b.length>=512)this.responseCallbacks[a.Events.onSendUpdateDone]&&this.responseCallbacks[a.Events.onSendUpdateDone](a.ResultCode.BadRequest);else{var c=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.UpdatePeers,b,!1);this.sendMessage(c.buffer)}},b.prototype.sendPrivateChat=function(b,c){var d=a.RequestBuilder.buildPrivateChatRequest(b,c);if(""==d)this.responseCallbacks[a.Events.onSendPrivateChatDone]&&this.responseCallbacks[a.Events.onSendPrivateChatDone](a.ResultCode.BadRequest);else{var e=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.PrivateChat,d,!0);this.sendMessage(e.buffer)}},b.prototype.updateRoomProperties=function(b,c,d){"undefined"==typeof d&&(d=null);var e=a.RequestBuilder.buildUpdateRoomPropertiesRequest(b,c,d),f=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.UpdateRoomProperty,e,!0);this.sendMessage(f.buffer)},b.prototype.lockProperties=function(b){var c=a.RequestBuilder.buildLockPropertiesRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.LockProperties,c,!0);this.sendMessage(d.buffer)},b.prototype.unlockProperties=function(b){var c=a.RequestBuilder.buildUnlockPropertiesRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.UnlockProperties,c,!0);this.sendMessage(d.buffer)},b.prototype.createTurnRoom=function(b,c,d,e,f){var g=a.RequestBuilder.buildCreateTurnRoomRequest(b,c,d,e,f),h=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.CreateRoom,g,!0);this.sendMessage(h.buffer)},b.prototype.sendMove=function(b){var c=a.RequestBuilder.buildSendMoveRequest(b),d=a.RequestBuilder.buildWarpRequest(this.SessionID,a.RequestType.Move,c,!0);this.sendMessage(d.buffer)},b.instance=null,b}();a.WarpClient=b}(AppWarp||(AppWarp={}));